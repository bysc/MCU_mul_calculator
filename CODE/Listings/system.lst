C51 COMPILER V9.54   SYSTEM                                                                11/24/2023 22:02:54 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE SYSTEM
OBJECT MODULE PLACED IN .\Objects\system.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE system.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\sy
                    -stem.lst) TABS(2) OBJECT(.\Objects\system.obj)

line level    source

   1          #include "system.h"
   2          void welcome()
   3          {
   4   1        lcd_init();
   5   1        lcd_printstr("Welcome!");
   6   1        lcd_gotoxy(1,0);
   7   1        lcd_printstr("bysc");
   8   1        lcd_delay(500);
   9   1        lcd_writecmd(0x01);
  10   1      }
  11          void clearStr(unsigned char *str,unsigned char len)
  12          {
  13   1        unsigned char i;
  14   1        for(i=0;i<len;i++) str[i]='\0';
  15   1      }
  16          void addStr(unsigned char *str,unsigned char *index,unsigned char press)
  17          {
  18   1        if(*index==15) 
  19   1        {
  20   2          lcd_init();
  21   2          lcd_printstr("space overflower");
  22   2          lcd_delay(1000);
  23   2          lcd_init();
  24   2          lcd_printstr(str);
  25   2        }
  26   1        else
  27   1        {
  28   2          (*index)++;
  29   2          str[*index]=press;
  30   2          lcd_writedata(press);
  31   2        }
  32   1      }
  33          void delStr(unsigned char *str,unsigned char *index)
  34          {
  35   1        if((*index)==-1)
  36   1        {
  37   2          lcd_init();
  38   2          lcd_printstr("space null");
  39   2          lcd_delay(1000);
  40   2        }
  41   1        else
  42   1        {
  43   2          str[*index]=0;
  44   2          (*index)--;
  45   2        }
  46   1        lcd_init();
  47   1        lcd_printstr(str);
  48   1      }
  49          void getAnswer(unsigned char *str,unsigned char *index)
  50          {
  51   1        float x1=0,x2=0,y=0;
  52   1        bit point1=0,operation=0,point2=0;
  53   1        unsigned char action=0;
  54   1        unsigned char i;
C51 COMPILER V9.54   SYSTEM                                                                11/24/2023 22:02:54 PAGE 2   

  55   1        float power=1;//浮点加权
  56   1        
  57   1        if((*index)==-1)
  58   1        {
  59   2            lcd_printstr("nothing to print");
  60   2            lcd_delay(1000);
  61   2            lcd_init();
  62   2            return;     
  63   2        }
  64   1        for(i=0;i<=(*index);i++)
  65   1        {
  66   2          if(str[i]=='+'||str[i]=='-'||str[i]=='*'||str[i]=='/') 
  67   2          {
  68   3            action=str[i];
  69   3            operation=1;
  70   3          }
  71   2          else if(str[i]=='.')//条件运算符不能做左值？
  72   2          {
  73   3            if(operation==1) point2=1;
  74   3            else point1=1;    
  75   3            power=1;
  76   3          }
  77   2          else if(point1==0 && operation==0) x1=x1*10+str[i]-'0';
  78   2          else if(point1==1 && operation==0) 
  79   2          {
  80   3            power*=0.1;
  81   3            x1+=(str[i]-'0')*power; 
  82   3          }
  83   2          //程序跑到这里运算符必定加载
  84   2          else if(point2==0) x2=x2*10+str[i]-'0';
  85   2          else if(point2==1) 
  86   2          {
  87   3            power*=0.1;
  88   3            x2+=(str[i]-'0')*power;
  89   3          }
  90   2          else 
  91   2          {
  92   3            x1=0;
  93   3            x2=0;
  94   3            lcd_gotoxy(1,0);
  95   3            lcd_printstr("unexp error");
  96   3            lcd_delay(1000);
  97   3          }
  98   2        }
  99   1        switch(action)
 100   1        {
 101   2          case '+': y=x1+x2;break;
 102   2          case '-': y=x1-x2;break;
 103   2          case '*': y=x1*x2;break;
 104   2          case '/': y=x1/x2;break;//x2=0,y=+INF
 105   2          default: y=x1;break;
 106   2        }
 107   1          clearStr(str,17);
 108   1          sprintf(str,"%.6f",y);
 109   1          lcd_gotoxy(1,0);
 110   1          lcd_printstr(str);
 111   1          (*index)=-1;
 112   1          point1=0;
 113   1          point2=0;
 114   1          operation=0;
 115   1          action=0;
 116   1      }
C51 COMPILER V9.54   SYSTEM                                                                11/24/2023 22:02:54 PAGE 3   



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1010    ----
   CONSTANT SIZE    =     76    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      40
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       3
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
